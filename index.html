<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XxDeadMaster's Printing Lair™ 3D Print Pricing Calculator</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @media print {
            body * {
                visibility: hidden;
            }
            #quote-content, #quote-content * {
                visibility: visible;
            }
            #quote-content {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
                padding: 20px;
            }
            .no-print {
                display: none !important;
            }
            .print-header {
                display: block !important;
            }
        }
        .print-header {
            display: none;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Lucide Icons as SVG components
        const Calculator = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <rect x="4" y="2" width="16" height="20" rx="2"/>
                <line x1="8" y1="6" x2="16" y2="6"/>
                <line x1="16" y1="14" x2="16" y2="18"/>
                <line x1="8" y1="14" x2="8" y2="14.01"/>
                <line x1="12" y1="14" x2="12" y2="14.01"/>
                <line x1="8" y1="18" x2="8" y2="18.01"/>
                <line x1="12" y1="18" x2="12" y2="18.01"/>
            </svg>
        );

        const Printer = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <polyline points="6 9 6 2 18 2 18 9"/>
                <path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"/>
                <rect x="6" y="14" width="12" height="8"/>
            </svg>
        );

        const Plus = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <line x1="12" y1="5" x2="12" y2="19"/>
                <line x1="5" y1="12" x2="19" y2="12"/>
            </svg>
        );

        const Trash2 = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <polyline points="3 6 5 6 21 6"/>
                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
                <line x1="10" y1="11" x2="10" y2="17"/>
                <line x1="14" y1="11" x2="14" y2="17"/>
            </svg>
        );

        const FileText = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                <polyline points="14 2 14 8 20 8"/>
                <line x1="16" y1="13" x2="8" y2="13"/>
                <line x1="16" y1="17" x2="8" y2="17"/>
                <line x1="10" y1="9" x2="8" y2="9"/>
            </svg>
        );

        const Download = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                <polyline points="7 10 12 15 17 10"/>
                <line x1="12" y1="15" x2="12" y2="3"/>
            </svg>
        );

        function PrintCalculator() {
            const [jobName, setJobName] = useState('');
            const [quantity, setQuantity] = useState(4);
            const [printerType, setPrinterType] = useState('fdm');
            const [laborRate, setLaborRate] = useState(0);
            const [printerRate, setPrinterRate] = useState(3);
            const [electricityRate, setElectricityRate] = useState(0.17);
            const [designTime, setDesignTime] = useState(0);
            const [programmingTime, setProgrammingTime] = useState(0);
            const [printTime, setPrintTime] = useState(1.56);
            const [postProcessTime, setPostProcessTime] = useState(0);
            const [materials, setMaterials] = useState([
                { id: 1, type: 'pla', cost: 15, used: 22 }
            ]);
            const [miscExpenses, setMiscExpenses] = useState(0);
            const [markup, setMarkup] = useState(20);

            const printerOptions = {
                fdm: { name: 'FDM Printer', materials: ['pla', 'abs', 'petg', 'tpu', 'nylon'] },
                resin: { name: 'Resin Printer', materials: ['standard', 'tough', 'flexible', 'castable', 'dental'] },
                sls: { name: 'SLS Printer', materials: ['nylon-pa12', 'nylon-pa11', 'tpu-sls'] }
            };

            const materialDefaults = {
                pla: { cost: 15, name: 'PLA' },
                abs: { cost: 18, name: 'ABS' },
                petg: { cost: 20, name: 'PETG' },
                tpu: { cost: 35, name: 'TPU (Flexible)' },
                nylon: { cost: 40, name: 'Nylon' },
                standard: { cost: 50, name: 'Standard Resin' },
                tough: { cost: 80, name: 'Tough Resin' },
                flexible: { cost: 90, name: 'Flexible Resin' },
                castable: { cost: 100, name: 'Castable Resin' },
                dental: { cost: 120, name: 'Dental Resin' },
                'nylon-pa12': { cost: 60, name: 'Nylon PA12' },
                'nylon-pa11': { cost: 65, name: 'Nylon PA11' },
                'tpu-sls': { cost: 75, name: 'TPU (SLS)' }
            };

            useEffect(() => {
                const availableMaterials = printerOptions[printerType].materials;
                setMaterials(prevMaterials => 
                    prevMaterials.map(mat => ({
                        ...mat,
                        type: availableMaterials.includes(mat.type) ? mat.type : availableMaterials[0],
                        cost: availableMaterials.includes(mat.type) ? mat.cost : materialDefaults[availableMaterials[0]].cost
                    }))
                );
            }, [printerType]);

            const addMaterial = () => {
                const availableMaterials = printerOptions[printerType].materials;
                const newMaterial = {
                    id: Date.now(),
                    type: availableMaterials[0],
                    cost: materialDefaults[availableMaterials[0]].cost,
                    used: 0
                };
                setMaterials([...materials, newMaterial]);
            };

            const removeMaterial = (id) => {
                if (materials.length > 1) {
                    setMaterials(materials.filter(mat => mat.id !== id));
                }
            };

            const updateMaterial = (id, field, value) => {
                setMaterials(materials.map(mat => 
                    mat.id === id ? { ...mat, [field]: value } : mat
                ));
            };

            const updateMaterialType = (id, newType) => {
                setMaterials(materials.map(mat => 
                    mat.id === id ? { ...mat, type: newType, cost: materialDefaults[newType].cost } : mat
                ));
            };

            const designCost = designTime * laborRate;
            const slicingCost = programmingTime * laborRate;
            const postProcessCost = postProcessTime * laborRate;
            const materialCostTotal = materials.reduce((total, mat) => 
                total + (mat.cost * mat.used / 1000) * quantity, 0
            );
            const electricityCost = electricityRate * printTime * quantity;
            const printingCost = printerRate * printTime * quantity;
            
            const subtotal = designCost + slicingCost + postProcessCost + materialCostTotal + electricityCost + printingCost + parseFloat(miscExpenses || 0);
            const markupAmount = subtotal * (markup / 100);
            const totalPrice = subtotal + markupAmount;
            const perPiecePrice = totalPrice / quantity;
            const profitMargin = totalPrice > 0 ? (markupAmount / totalPrice) * 100 : 0;

            const handlePrint = () => {
                window.print();
            };

            const handleExportPDF = () => {
                window.print();
            };

            return (
                <div className="min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 p-4 md:p-8">
                    <div className="max-w-5xl mx-auto bg-white rounded-2xl shadow-2xl overflow-hidden">
                        <div className="bg-gradient-to-r from-orange-500 to-red-500 p-6 text-white">
                            <div className="flex items-center gap-3 justify-center">
                                <Calculator />
                                <h1 className="text-3xl font-bold">CalcPRO™ 3D Print Pricing Calculator</h1>
                            </div>
                        </div>

                        <div className="p-6 md:p-8 space-y-8" id="quote-content">
                            <div className="print-header mb-6">
                                <h1 className="text-3xl font-bold text-orange-600 text-center mb-2">3D Printing Quote</h1>
                                <p className="text-center text-gray-600">Generated: {new Date().toLocaleDateString()}</p>
                            </div>

                            <section>
                                <h2 className="text-2xl font-bold text-orange-600 mb-4 text-center">Job Info:</h2>
                                <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">Job Name</label>
                                        <input
                                            type="text"
                                            value={jobName}
                                            onChange={(e) => setJobName(e.target.value)}
                                            placeholder="Enter text"
                                            className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent no-print"
                                        />
                                        <div className="print-header font-semibold">{jobName || 'N/A'}</div>
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">Total Job Quantity</label>
                                        <input
                                            type="number"
                                            value={quantity}
                                            onChange={(e) => setQuantity(Math.max(1, parseInt(e.target.value) || 1))}
                                            className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent no-print"
                                        />
                                        <div className="print-header font-semibold">{quantity}</div>
                                    </div>
                                </div>
                            </section>

                            <section className="no-print">
                                <h2 className="text-2xl font-bold text-orange-600 mb-4 text-center">Printer:</h2>
                                <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                                    {Object.entries(printerOptions).map(([key, value]) => (
                                        <button
                                            key={key}
                                            onClick={() => setPrinterType(key)}
                                            className={`p-4 rounded-lg border-2 transition-all flex items-center gap-3 ${
                                                printerType === key
                                                    ? 'border-orange-500 bg-orange-50 shadow-md'
                                                    : 'border-gray-200 hover:border-orange-300'
                                            }`}
                                        >
                                            <Printer />
                                            <span className={`font-medium ${printerType === key ? 'text-orange-600' : 'text-gray-700'}`}>
                                                {value.name}
                                            </span>
                                        </button>
                                    ))}
                                </div>
                            </section>

                            <section className="no-print">
                                <h2 className="text-2xl font-bold text-orange-600 mb-4 text-center">Rates:</h2>
                                <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">Labor Rate (per hour)</label>
                                        <input
                                            type="number"
                                            step="0.01"
                                            value={laborRate}
                                            onChange={(e) => setLaborRate(parseFloat(e.target.value) || 0)}
                                            placeholder="Enter Labor Rate *"
                                            className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"
                                        />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">Printer Rate (per hour)</label>
                                        <input
                                            type="number"
                                            step="0.01"
                                            value={printerRate}
                                            onChange={(e) => setPrinterRate(parseFloat(e.target.value) || 0)}
                                            className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"
                                        />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">Electricity Rate (per kWh/hr)</label>
                                        <input
                                            type="number"
                                            step="0.01"
                                            value={electricityRate}
                                            onChange={(e) => setElectricityRate(parseFloat(e.target.value) || 0)}
                                            className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"
                                        />
                                    </div>
                                </div>
                            </section>

                            <section className="no-print">
                                <h2 className="text-2xl font-bold text-orange-600 mb-4 text-center">Time:</h2>
                                <div className="grid grid-cols-2 md:grid-cols-4 gap-6">
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">Design Time (hrs)</label>
                                        <input
                                            type="number"
                                            step="0.01"
                                            value={designTime}
                                            onChange={(e) => setDesignTime(parseFloat(e.target.value) || 0)}
                                            placeholder="Enter a number *"
                                            className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"
                                        />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">Programming Time (hrs)</label>
                                        <input
                                            type="number"
                                            step="0.01"
                                            value={programmingTime}
                                            onChange={(e) => setProgrammingTime(parseFloat(e.target.value) || 0)}
                                            placeholder="Enter a number *"
                                            className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"
                                        />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">Total Print Time (hrs)</label>
                                        <input
                                            type="number"
                                            step="0.01"
                                            value={printTime}
                                            onChange={(e) => setPrintTime(parseFloat(e.target.value) || 0)}
                                            className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"
                                        />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">Post Processing Time (hrs)</label>
                                        <input
                                            type="number"
                                            step="0.01"
                                            value={postProcessTime}
                                            onChange={(e) => setPostProcessTime(parseFloat(e.target.value) || 0)}
                                            placeholder="Enter a number *"
                                            className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"
                                        />
                                    </div>
                                </div>
                            </section>

                            <section className="no-print">
                                <div className="flex items-center justify-between mb-4">
                                    <h2 className="text-2xl font-bold text-orange-600">Materials:</h2>
                                    <button
                                        onClick={addMaterial}
                                        className="flex items-center gap-2 px-4 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600 transition-colors"
                                    >
                                        <Plus />
                                        Add Material
                                    </button>
                                </div>
                                
                                <div className="space-y-4">
                                    {materials.map((material, index) => (
                                        <div key={material.id} className="bg-slate-50 p-4 rounded-lg border-2 border-slate-200">
                                            <div className="flex items-center justify-between mb-3">
                                                <h3 className="font-semibold text-gray-700">Material {index + 1}</h3>
                                                {materials.length > 1 && (
                                                    <button
                                                        onClick={() => removeMaterial(material.id)}
                                                        className="text-red-500 hover:text-red-700 transition-colors"
                                                    >
                                                        <Trash2 />
                                                    </button>
                                                )}
                                            </div>
                                            <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                                                <div>
                                                    <label className="block text-sm font-medium text-gray-700 mb-2">Material Type</label>
                                                    <select
                                                        value={material.type}
                                                        onChange={(e) => updateMaterialType(material.id, e.target.value)}
                                                        className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent bg-white"
                                                    >
                                                        {printerOptions[printerType].materials.map((mat) => (
                                                            <option key={mat} value={mat}>
                                                                {materialDefaults[mat].name}
                                                            </option>
                                                        ))}
                                                    </select>
                                                </div>
                                                <div>
                                                    <label className="block text-sm font-medium text-gray-700 mb-2">
                                                        Cost (per {printerType === 'resin' ? 'liter' : 'kg'})
                                                    </label>
                                                    <input
                                                        type="number"
                                                        step="0.01"
                                                        value={material.cost}
                                                        onChange={(e) => updateMaterial(material.id, 'cost', parseFloat(e.target.value) || 0)}
                                                        className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"
                                                    />
                                                </div>
                                                <div>
                                                    <label className="block text-sm font-medium text-gray-700 mb-2">
                                                        Used ({printerType === 'resin' ? 'ml' : 'grams'})
                                                    </label>
                                                    <input
                                                        type="number"
                                                        step="0.01"
                                                        value={material.used}
                                                        onChange={(e) => updateMaterial(material.id, 'used', parseFloat(e.target.value) || 0)}
                                                        className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"
                                                    />
                                                </div>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </section>

                            <section className="no-print">
                                <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">
                                            Misc. Expenses (hardware, paint, etc.)
                                        </label>
                                        <input
                                            type="number"
                                            step="0.01"
                                            value={miscExpenses}
                                            onChange={(e) => setMiscExpenses(parseFloat(e.target.value) || 0)}
                                            placeholder="Enter a number *"
                                            className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"
                                        />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">Material Markup (%)</label>
                                        <div className="flex items-center gap-4">
                                            <input
                                                type="range"
                                                min="0"
                                                max="100"
                                                value={markup}
                                                onChange={(e) => setMarkup(parseInt(e.target.value))}
                                                className="flex-1"
                                            />
                                            <span className="text-lg font-semibold text-orange-600 w-12">{markup}%</span>
                                        </div>
                                    </div>
                                </div>
                            </section>

                            <section className="bg-slate-50 rounded-xl p-6">
                                <h2 className="text-2xl font-bold text-orange-600 mb-4 text-center">Job Price Breakdown:</h2>
                                <div className="space-y-2">
                                    <div className="flex justify-between py-2 border-b border-gray-200">
                                        <span className="text-gray-700">Design</span>
                                        <span className="font-semibold">{designCost.toFixed(2)} USD</span>
                                    </div>
                                    <div className="flex justify-between py-2 border-b border-gray-200">
                                        <span className="text-gray-700">Slicing/Programming</span>
                                        <span className="font-semibold">{slicingCost.toFixed(2)} USD</span>
                                    </div>
                                    <div className="flex justify-between py-2 border-b border-gray-200">
                                        <span className="text-gray-700">Post Processing</span>
                                        <span className="font-semibold">{postProcessCost.toFixed(2)} USD</span>
                                    </div>
                                    <div className="flex justify-between py-2 border-b border-gray-200">
                                        <span className="text-gray-700">Material (Total)</span>
                                        <span className="font-semibold">{materialCostTotal.toFixed(2)} USD</span>
                                    </div>
                                    <div className="flex justify-between py-2 border-b border-gray-200">
                                        <span className="text-gray-700">Electricity</span>
                                        <span className="font-semibold">{electricityCost.toFixed(2)} USD</span>
                                    </div>
                                    <div className="flex justify-between py-2 border-b border-gray-200">
                                        <span className="text-gray-700">Printing</span>
                                        <span className="font-semibold">{printingCost.toFixed(2)} USD</span>
                                    </div>
                                    <div className="flex justify-between py-2 border-b border-gray-200">
                                        <span className="text-gray-700">Misc. Expenses</span>
                                        <span className="font-semibold">{parseFloat(miscExpenses || 0).toFixed(2)} USD</span>
                                    </div>
                                    <div className="flex justify-between py-2 border-b-2 border-gray-400">
                                        <span className="text-gray-700 font-medium">Markup ({markup}%)</span>
                                        <span className="font-semibold">{markupAmount.toFixed(2)} USD</span>
                                    </div>
                                    <div className="flex justify-between py-2 border-b border-gray-200 bg-orange-50">
                                        <span className="text-gray-700 font-medium">Profit Margin</span>
                                        <span className="font-semibold text-orange-600">{profitMargin.toFixed(2)}%</span>
                                    </div>
                                </div>
                            </section>

                            <section className="bg-gradient-to-r from-orange-500 to-red-500 rounded-xl p-6 text-white">
                                <h2 className="text-2xl font-bold mb-4 text-center">Final Pricing:</h2>
                                <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div className="text-center">
                                        <div className="text-sm opacity-90 mb-1">Total Job Price</div>
                                        <div className="text-4xl font-bold">{totalPrice.toFixed(2)} USD</div>
                                    </div>
                                    <div className="text-center">
                                        <div className="text-sm opacity-90 mb-1">Per Piece Price</div>
                                        <div className="text-4xl font-bold">{perPiecePrice.toFixed(2)} USD</div>
                                    </div>
                                </div>
                            </section>

                            <section className="no-print flex gap-4 justify-center">
                                <button
                                    onClick={handlePrint}
                                    className="flex items-center gap-2 px-6 py-3 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors shadow-lg"
                                >
                                    <FileText />
                                    Print Quote
                                </button>
                                <button
                                    onClick={handleExportPDF}
                                    className="flex items-center gap-2 px-6 py-3 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors shadow-lg"
                                >
                                    <Download />
                                    Export PDF
                                </button>
                            </section>
                        </div>
                    </div>
                </div>
            );
        }

        ReactDOM.render(<PrintCalculator />, document.getElementById('root'));
    </script>
</body>
</html>